<Window x:Class="TestWpfApplication.XmlSigningWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Signature XML avec Azure Key Vault" Height="750" Width="900"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="DarkBlue"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>

        <Style x:Key="StatusTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Titre -->
        <TextBlock Grid.Row="0" 
                   Text="🔐 Signature de Documents XML avec Azure Key Vault" 
                   FontSize="18" 
                   FontWeight="Bold" 
                   HorizontalAlignment="Center" 
                   Margin="10"
                   Foreground="DarkSlateGray"/>

        <!-- Configuration Azure Key Vault -->
        <GroupBox Grid.Row="1" Header="⚙️ Configuration Azure Key Vault" Margin="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="140"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="URL Key Vault :" VerticalAlignment="Center"/>
                <TextBox Grid.Row="0" Grid.Column="1" x:Name="KeyVaultUrlTextBox" 
                         Height="25" Margin="5" 
                         Text="https://your-keyvault.vault.azure.net/"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Nom Certificat :" VerticalAlignment="Center"/>
                <TextBox Grid.Row="1" Grid.Column="1" x:Name="CertificateNameTextBox" 
                         Height="25" Margin="5" 
                         Text="signing-certificate"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Tenant ID :" VerticalAlignment="Center"/>
                <TextBox Grid.Row="2" Grid.Column="1" x:Name="TenantIdTextBox" 
                         Height="25" Margin="5" 
                         Text="your-tenant-id"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="Client ID :" VerticalAlignment="Center"/>
                <TextBox Grid.Row="3" Grid.Column="1" x:Name="ClientIdTextBox" 
                         Height="25" Margin="5" 
                         Text="your-client-id"/>

                <TextBlock Grid.Row="4" Grid.Column="0" Text="Client Secret :" VerticalAlignment="Center"/>
                <PasswordBox Grid.Row="4" Grid.Column="1" x:Name="ClientSecretPasswordBox" 
                             Height="25" Margin="5"/>

                <TextBlock Grid.Row="5" Grid.Column="0" Text="Authentification :" VerticalAlignment="Center"/>
                <ComboBox Grid.Row="5" Grid.Column="1" x:Name="AuthMethodComboBox" 
                          Height="25" Margin="5" SelectedIndex="0">
                    <ComboBoxItem Content="Client Secret"/>
                    <ComboBoxItem Content="Managed Identity"/>
                    <ComboBoxItem Content="Interactive Browser"/>
                </ComboBox>

                <Button Grid.Row="5" Grid.Column="2" x:Name="TestConnectionButton" 
                        Content="🔍 Tester" Width="80" Height="25" Margin="5"
                        Click="TestConnectionButton_Click"/>
            </Grid>
        </GroupBox>

        <!-- Sélection et signature de fichier -->
        <GroupBox Grid.Row="2" Header="📄 Signature de Document XML" Margin="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Fichier XML :" VerticalAlignment="Center"/>
                <TextBox Grid.Row="0" Grid.Column="1" x:Name="XmlFilePathTextBox" 
                         Height="25" Margin="5" IsReadOnly="True"/>
                <Button Grid.Row="0" Grid.Column="2" x:Name="BrowseXmlButton" 
                        Content="📁 Parcourir" Width="90" Height="25" Margin="5"
                        Click="BrowseXmlButton_Click"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Fichier Signé :" VerticalAlignment="Center"/>
                <TextBox Grid.Row="1" Grid.Column="1" x:Name="OutputFilePathTextBox" 
                         Height="25" Margin="5"/>
                <Button Grid.Row="1" Grid.Column="2" x:Name="BrowseOutputButton" 
                        Content="📁 Destination" Width="90" Height="25" Margin="5"
                        Click="BrowseOutputButton_Click"/>

                <StackPanel Grid.Row="2" Grid.ColumnSpan="3" 
                            Orientation="Horizontal" HorizontalAlignment="Center" Margin="10">
                    <Button x:Name="SignXmlButton" 
                            Content="✍️ Signer le Document" 
                            Width="150" Height="35" Margin="5"
                            Click="SignXmlButton_Click"
                            Background="LightGreen"/>
                    <Button x:Name="VerifySignatureButton" 
                            Content="✅ Vérifier Signature" 
                            Width="140" Height="35" Margin="5"
                            Click="VerifySignatureButton_Click"
                            Background="LightBlue"/>
                    <Button x:Name="DownloadSignedButton" 
                            Content="💾 Télécharger" 
                            Width="120" Height="35" Margin="5"
                            Click="DownloadSignedButton_Click"
                            Background="LightYellow"
                            IsEnabled="False"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Journal des opérations -->
        <GroupBox Grid.Row="3" Header="📝 Journal des Opérations" Margin="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <TextBox x:Name="LogTextBox" 
                         IsReadOnly="True" 
                         AcceptsReturn="True"
                         FontFamily="Consolas"
                         FontSize="11"
                         Background="Black"
                         Foreground="Lime"
                         Padding="10"/>
            </ScrollViewer>
        </GroupBox>

        <!-- Barre de statut -->
        <StatusBar Grid.Row="4">
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <Ellipse x:Name="StatusIndicator" 
                             Width="10" Height="10" 
                             Fill="Gray" Margin="0,0,5,0"/>
                    <TextBlock x:Name="StatusTextBlock" Text="Prêt"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="TimestampTextBlock" Text=""/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>